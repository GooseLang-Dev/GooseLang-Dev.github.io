"use strict";(self.webpackChunkgooselang_docs=self.webpackChunkgooselang_docs||[]).push([[6382],{3033:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>d,contentTitle:()=>o,default:()=>u,frontMatter:()=>l,metadata:()=>r,toc:()=>a});const r=JSON.parse('{"id":"data-structure/problem-data","title":"Problem Data","description":"\ud83d\udcd8 Overview","source":"@site/i18n/en/docusaurus-plugin-content-docs/current/data-structure/problem-data.md","sourceDirName":"data-structure","slug":"/data-structure/problem-data","permalink":"/dev/data-structure/problem-data","draft":false,"unlisted":false,"editUrl":"https://github.com/GooseLang-Dev/gooselang.github.io/tree/main/i18n/en/docusaurus-plugin-content-docs/current/data-structure/problem-data.md","tags":[],"version":"current","lastUpdatedBy":"BruceWJ","lastUpdatedAt":1754286127000,"sidebarPosition":2,"frontMatter":{"title":"Problem Data","sidebar_position":2,"id":"problem-data"},"sidebar":"devSidebar","previous":{"title":"Language Settings","permalink":"/dev/data-structure/lang-settings"},"next":{"title":"Question Data","permalink":"/dev/data-structure/question-data"}}');var i=s(4848),t=s(8453);const l={title:"Problem Data",sidebar_position:2,id:"problem-data"},o="Problem Data Structure & Model",d={},a=[{value:"\ud83d\udcd8 Overview",id:"-overview",level:2},{value:"\ud83d\udcc1 File Structure",id:"-file-structure",level:2},{value:"\ud83d\udcc4 Problem Data Structure",id:"-problem-data-structure",level:2},{value:"Doc Type Constants",id:"doc-type-constants",level:3},{value:"Problem Document (<code>ProblemDoc</code>)",id:"problem-document-problemdoc",level:3},{value:"Key Fields",id:"key-fields",level:4},{value:"Related Types",id:"related-types",level:4},{value:"Problem Status Document (<code>ProblemStatusDoc</code>)",id:"problem-status-document-problemstatusdoc",level:3},{value:"Record Document (<code>RecordDoc</code>)",id:"record-document-recorddoc",level:3},{value:"\ud83d\udce6 Problem Model &amp; Logic",id:"-problem-model--logic",level:2},{value:"Core Methods &amp; Logic (ProblemModel)",id:"core-methods--logic-problemmodel",level:3},{value:"\ud83d\udcdd Problem Submission &amp; Progress Flow",id:"-problem-submission--progress-flow",level:2},{value:"\ud83d\udccc Notes / Observations",id:"-notes--observations",level:2},{value:"\ud83d\udca1 Usage Examples",id:"-usage-examples",level:2}];function c(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"problem-data-structure--model",children:"Problem Data Structure & Model"})}),"\n",(0,i.jsx)(n.h2,{id:"-overview",children:"\ud83d\udcd8 Overview"}),"\n",(0,i.jsxs)(n.p,{children:["The GooseLang ",(0,i.jsx)(n.strong,{children:"Problem"})," data structure and model provide a flexible, extensible system for managing language learning problems (exercises) within the GooseLang platform. This system enables the creation, storage, and management of problems, including their metadata, content, files, and user progress tracking. Problems are tightly integrated with language settings, user management, and the document system, supporting a wide range of learning scenarios and analytics."]}),"\n",(0,i.jsx)(n.p,{children:"The model is designed to:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Store and retrieve problem definitions, metadata, and multilingual content"}),"\n",(0,i.jsx)(n.li,{children:"Manage problem files (materials, questions, additional resources)"}),"\n",(0,i.jsx)(n.li,{children:"Track user submissions, scores, and progress"}),"\n",(0,i.jsx)(n.li,{children:"Support localization, tagging, and reference relationships"}),"\n",(0,i.jsx)(n.li,{children:"Enable fine-grained access control and extensibility"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"-file-structure",children:"\ud83d\udcc1 File Structure"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"src/model/problem.ts"}),": Main implementation of the ",(0,i.jsx)(n.code,{children:"ProblemModel"})," class, providing all core logic for problem management, including CRUD operations, file handling, and business rules."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"src/interface.ts"}),": TypeScript interfaces and type definitions for all problem-related documents and data structures."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"docs/data-structure/problem-data.md"}),": This documentation file, describing the data model and its usage."]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"-problem-data-structure",children:"\ud83d\udcc4 Problem Data Structure"}),"\n",(0,i.jsx)(n.h3,{id:"doc-type-constants",children:"Doc Type Constants"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"export const TYPE_PROBLEM = 10; // Problem document type\n"})}),"\n",(0,i.jsxs)(n.h3,{id:"problem-document-problemdoc",children:["Problem Document (",(0,i.jsx)(n.code,{children:"ProblemDoc"}),")"]}),"\n",(0,i.jsx)(n.p,{children:"Represents a single problem (exercise) in the system, with all associated metadata, content, and files."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"export interface ProblemDoc extends Document {\n    docType: typeof TYPE_PROBLEM; // 10\n    pid: string; // Problem identifier (user-defined or auto-generated)\n    spaceId: string;\n    docId: number; // Auto-generated unique ID\n    Owner: number;\n    langData: {\n        targetLangId: ObjectId;\n        isTargetLangCustom: boolean;\n        typeId: ObjectId; // Problem type (e.g., listening, speaking)\n        levelId: ObjectId;\n    };\n    tag: string[];\n    nSubmit: number;\n    avgTime: number;\n    avgScore: number;\n    nRate: number;\n    rate: number;\n    sort?: string;\n    reference?: { spaceId: string; pid: string };\n    isHidden: boolean;\n    description: LocalizedContent;\n    title: LocalizedContent;\n    MaterialFile?: FileInfo[];\n    AdditionalFile?: FileInfo[];\n    QuestionFile?: FileInfo[];\n}\n"})}),"\n",(0,i.jsx)(n.h4,{id:"key-fields",children:"Key Fields"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"pid"}),": Problem identifier (e.g., 'EN-L#321'), can be user-defined or auto-generated"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"langData"}),": Language, type, and level references for this problem"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"tag"}),": Array of tags for filtering and categorization"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"MaterialFile / AdditionalFile / QuestionFile"}),": Arrays of file metadata for attached resources"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"description / title"}),": Localized content for UI display"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"reference"}),": Optional reference to another problem (for derived/related problems)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"isHidden"}),": Controls visibility"]}),"\n"]}),"\n",(0,i.jsx)(n.h4,{id:"related-types",children:"Related Types"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"FileInfo"}),": Metadata for files (name, size, etag, lastModified, etc.)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"LocalizedContent"}),": Multilingual content (e.g., ",(0,i.jsx)(n.code,{children:'{ en: "...", zh: "..." }'}),")"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"ObjectId"}),": MongoDB object identifier"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"Document"}),": Base document fields (from ",(0,i.jsx)(n.code,{children:"@interface.ts"}),")"]}),"\n"]}),"\n",(0,i.jsxs)(n.h3,{id:"problem-status-document-problemstatusdoc",children:["Problem Status Document (",(0,i.jsx)(n.code,{children:"ProblemStatusDoc"}),")"]}),"\n",(0,i.jsx)(n.p,{children:"Tracks user-specific progress, scores, and status for a problem."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"export interface ProblemStatusDoc extends StatusDocBase {\n    docId: number;\n    docType: 10;\n    highestRid?: ObjectId;\n    currentRid?: ObjectId;\n    qid?: ObjectId;\n    star?: boolean;\n    status?: number; // 0: not started/finished, 1: in progress\n    score?: number; // highest score\n    avgScore?: number; // average score\n    tries?: number; // number of attempts\n}\n"})}),"\n",(0,i.jsxs)(n.h3,{id:"record-document-recorddoc",children:["Record Document (",(0,i.jsx)(n.code,{children:"RecordDoc"}),")"]}),"\n",(0,i.jsx)(n.p,{children:"Stores individual user submission records for a problem."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"export interface RecordDoc {\n    _id: ObjectId;\n    spaceId: string;\n    pid: number;\n    uid: number;\n    score: number;\n    time?: number;\n    startAt?: Array<Date>;\n    endAt?: Array<Date>;\n    isJudged?: number;\n    questionRecod?: any[];\n}\n"})}),"\n",(0,i.jsx)(n.h2,{id:"-problem-model--logic",children:"\ud83d\udce6 Problem Model & Logic"}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"ProblemModel"})," class (in ",(0,i.jsx)(n.code,{children:"model/problem.ts"}),") provides all business logic for managing problems. Key responsibilities include:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"CRUD Operations"}),": Add, edit, delete, and retrieve problems"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"File Management"}),": Attach, rename, and delete files (materials, questions, etc.)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Status Tracking"}),": Track user progress, submissions, and scores"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Reference Handling"}),": Support for referencing other problems (e.g., for derived or related problems)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Localization & Tagging"}),": Support for multilingual content and flexible tagging"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Access Control"}),": Permission checks for user access to problems"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"core-methods--logic-problemmodel",children:"Core Methods & Logic (ProblemModel)"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"add(spaceId, pid, title, description, owner, tag, isHidden, langData, reference)"}),": Create a new problem"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"addWithId(...)"}),": Create a new problem with a specific docId"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"get(spaceId, pid, projection?)"}),": Retrieve a problem by ID or PID"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"getMulti(spaceId, query, projection?)"}),": Retrieve multiple problems by query"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"edit(spaceId, _id, $set)"}),": Update problem fields"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"del(spaceId, docId)"}),": Delete a problem and associated files/status"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"addFile(spaceId, docId, type, file, name, ...)"}),": Attach a file to a problem"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"delFile(spaceId, docId, type, name, ...)"}),": Remove a file from a problem"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"renameFile(spaceId, docId, file, newName, ...)"}),": Rename a file"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"getStatus(spaceId, docId, uid)"}),": Get user-specific status for a problem"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"updateStatus(spaceId, pid, uid, args)"}),": Update user status"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"incStatus(spaceId, pid, uid, key, count)"}),": Increment a status field"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"canViewBy(pdoc, udoc)"}),": Check if a user can view a problem"]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["All methods interact with the ",(0,i.jsx)(n.code,{children:"document"})," MongoDB collection, using the ",(0,i.jsx)(n.code,{children:"docType"})," field to distinguish document roles."]}),"\n",(0,i.jsx)(n.h2,{id:"-problem-submission--progress-flow",children:"\ud83d\udcdd Problem Submission & Progress Flow"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"User Submits Solution"}),": A user submits an answer to a problem."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Record Creation"}),": A ",(0,i.jsx)(n.code,{children:"RecordDoc"})," is created, storing the submission, time, and score."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Status Update"}),": The user's ",(0,i.jsx)(n.code,{children:"ProblemStatusDoc"})," is updated with new scores, tries, and progress."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Problem Aggregation"}),": Problem-level stats (",(0,i.jsx)(n.code,{children:"nSubmit"}),", ",(0,i.jsx)(n.code,{children:"avgScore"}),", etc.) are updated."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"File Attachments"}),": If the problem includes files (audio, text, etc.), these are managed via the file methods."]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"-notes--observations",children:"\ud83d\udccc Notes / Observations"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Extensibility"}),": The model supports custom language types, levels, and flexible tagging."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Localization"}),": All user-facing content (title, description) is localized via ",(0,i.jsx)(n.code,{children:"LocalizedContent"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Reference Problems"}),": Problems can reference others, supporting derived or related exercises."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"File Management"}),": Problems can have multiple associated files, each tracked with metadata."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Status & Progress"}),": Fine-grained tracking of user progress and scores is built-in."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Integration"}),": The Problem model is tightly integrated with the document system, user management, and language settings."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Error Handling"}),": Most methods throw descriptive errors if data is missing or invalid, aiding debugging and robustness."]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"-usage-examples",children:"\ud83d\udca1 Usage Examples"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"// Create a new problem\nawait ProblemModel.add(\n    'space123',\n    'EN-L#321',\n    { en: 'Listening Exercise 1' },\n    { en: 'Listen and repeat' },\n    1, // owner\n    ['listening', 'beginner'],\n    false, // isHidden\n    {\n        targetLangId: new ObjectId(),\n        isTargetLangCustom: false,\n        typeId: new ObjectId(),\n        levelId: new ObjectId(),\n    },\n    {} // reference (optional)\n);\n\n// Attach a material file\nawait ProblemModel.addFile('space123', 123, 'MaterialFile', fileBuffer, 'audio.mp3');\n\n// Get a problem by PID\nconst problem = await ProblemModel.get('space123', 'EN-L#321');\n\n// Update a problem's tags\nawait ProblemModel.edit('space123', 123, { tag: ['listening', 'advanced'] });\n\n// Track user progress\nawait ProblemModel.updateStatus('space123', 123, 42, { score: 95, status: 1 });\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsxs)(n.p,{children:["For further details, see the source code in ",(0,i.jsx)(n.code,{children:"src/model/problem.ts"})," and ",(0,i.jsx)(n.code,{children:"src/interface.ts"}),"."]})]})}function u(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>l,x:()=>o});var r=s(6540);const i={},t=r.createContext(i);function l(e){const n=r.useContext(t);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:l(e.components),r.createElement(t.Provider,{value:n},e.children)}}}]);